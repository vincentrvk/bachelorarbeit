Du sollst ein Skript für die Integration von eFiling of Employees Payments für UK erstellen. Es soll das Earlier Year Update importiert werden. 

1. Header, Properties und Body
--------------------
Headers:

Properties:
requestUser = 
requestPassword = 
requestURL = 


Sollten Properties und Header bereits im Message-Objekt vorhanden sein, befülle die Variablen mit den vorhandenen Werten. Ist ein Wert nicht zu finden benutze "placeholder".


2. Mapping:
-----------
- Mappe den eingehenden Payload gemäß den Mapping-Anforderungen des Request Mappings


3. Message-Digest:
------------------
- Bilde den SHA1 Message Digest des Payloads und füge den Wert in den Payload ein
- Element und Pfad für den Message Digest Wert:
	- Element: "IRmark"
	- Pfad: GovTalkMessage/Body/IRenvelope/IRheader/IRmark


4. DataStore Write:
-------------------
- Schreibe den Payload nach Schritt 3 in folgenden DataStore:
	- Name: "EYU17-18"
	- EntryId: MessageID der Message


5. Request "Set Results":
-----------------
Adresse: ${property.requestURL}
Methode: POST
Authentifizierung: Basic-Authentication
Header: keine
Body: Payload nach Message Digest

Response Handling: 
- kein Response Handling



Modularität-Anforderungen:
1. Schreibe eine separate Funktion für jeden API-Call
2. Schreibe eine separate Funktion für das Mapping
3. Schreibe eine separate Funktion zum festlegen der Werte (Headers & Properties)
4. Schreibe eine separate Funktion für das Error Handling
5. Schreibe eine separate Funktion für das Message Digest Handling


Validierungsregeln:


Mapping-Anforderungen:
REQUEST-MAPPING: 
Quellfeld -> Zielfeld

SenderID -> GovTalkMessage/Header/SenderDetails/IDAuthentication/SenderID

Value -> GovTalkMessage/Header/SenderDetails/IDAuthentication/Authentication/Value

Product -> GovTalkMessage/GovTalkDetails/ChannelRouting/Channel/Product

Timestamp -> GovTalkMessage/GovTalkDetails/ChannelRouting/Timestamp

PeriodEnd ->  GovTalkMessage/Body/IRenvelope/IRheader/PeriodEnd



RESPONSE-MAPPING:
Quellfeld -> Zielfeld
kein Response Mapping


---
Input:
INPUT REQUEST MAPPING:
<Root xmlns="http://www.govtalk.gov.uk/CM/envelope">
  <SenderID>HMRC</SenderID>
  <Value>abc123</Value>
  <Product>TaxSystem</Product>
  <Timestamp>2025-05-28T12:00:00Z</Timestamp>
  <PeriodEnd>2025-04-30</PeriodEnd>
</Root>



INPUT RESPONSE MAPPING:
keins



Input-Schema:
INPUT SCHEMA REQUEST MAPPING:
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema 
  xmlns:xs="http://www.w3.org/2001/XMLSchema" 
  targetNamespace="http://www.govtalk.gov.uk/CM/envelope" 
  xmlns="http://www.govtalk.gov.uk/CM/envelope" 
  elementFormDefault="qualified">
  <xs:element name="Root">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="SenderID" type="xs:string"/>
        <xs:element name="Value" type="xs:string"/>
        <xs:element name="Product" type="xs:string"/>
        <xs:element name="Timestamp" type="xs:dateTime"/>
		<xs:element name="PeriodEnd" type="xs:string"/>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>




INPUT SCHEMA RESPONSE MAPPING:
keins




Output: 
OUTPUT REQUEST MAPPING:
<?xml version="1.0" encoding="UTF-8"?>
<GovTalkMessage
	xmlns="http://www.govtalk.gov.uk/CM/envelope">
	<EnvelopeVersion/>
	<Header>
		<MessageDetails>
			<Class/>
			<Qualifier/>
			<CorrelationID/>
			<GatewayTimestamp/>
		</MessageDetails>
		<SenderDetails>
			<IDAuthentication>
				<SenderID>HMRC</SenderID>
				<Authentication>
					<Method/>
					<Value>abc123</Value>
				</Authentication>
			</IDAuthentication>
		</SenderDetails>
	</Header>
	<GovTalkDetails>
		<ChannelRouting>
			<Channel>
				<Product>TaxSystem</Product>
			</Channel>
			<Timestamp>2025-05-28T12:00:00Z</Timestamp>
		</ChannelRouting>
	</GovTalkDetails>
	<Body>
		<IRenvelope
			xmlns="http://www.govtalk.gov.uk/taxation/PAYE/RTI/EarlierYearUpdate/16-17/1">
			<IRheader>
				<Keys>
					<Key Type="TaxOfficeNumber"/>
					<Key Type="TaxOfficeReference"/>
				</Keys>
				<PeriodEnd>2025-04-30</PeriodEnd>
				<Sender/>
			</IRheader>
			<EarlierYearUpdate>
				<RelatedTaxYear/>
			</EarlierYearUpdate>
		</IRenvelope>
	</Body>
</GovTalkMessage>




OUTPUT RESPONSE MAPPING:
keins



Output Schema:
OUTPUT SCHEMA REQUEST MAPPING:
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           targetNamespace="http://www.govtalk.gov.uk/CM/envelope"
           xmlns="http://www.govtalk.gov.uk/CM/envelope"
           elementFormDefault="qualified">
  <xs:element name="GovTalkMessage">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="EnvelopeVersion" type="xs:string" minOccurs="0"/>
        <xs:element name="Header">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="MessageDetails">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="Class" type="xs:string" minOccurs="0"/>
                    <xs:element name="Qualifier" type="xs:string" minOccurs="0"/>
                    <xs:element name="CorrelationID" type="xs:string" minOccurs="0"/>
                    <xs:element name="GatewayTimestamp" type="xs:string" minOccurs="0"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
              <xs:element name="SenderDetails">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="IDAuthentication">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="SenderID" type="xs:string"/>
                          <xs:element name="Authentication">
                            <xs:complexType>
                              <xs:sequence>
                                <xs:element name="Method" type="xs:string" minOccurs="0"/>
                                <xs:element name="Value" type="xs:string"/>
                              </xs:sequence>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="GovTalkDetails">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="ChannelRouting">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="Channel">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="Product" type="xs:string"/>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                    <xs:element name="Timestamp" type="xs:string"/>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
        <xs:element name="Body">
          <xs:complexType>
            <xs:sequence>
              <xs:element ref="rti:IRenvelope"/>
            </xs:sequence>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
  <!-- Import für RTI-Namespace -->
  <xs:import namespace="http://www.govtalk.gov.uk/taxation/PAYE/RTI/EarlierYearUpdate/16-17/1"
             schemaLocation="rti.xsd"/>
</xs:schema>





OUTPUT SCHEMA RESPONSE MAPPING:
keins



