Excel-XML Input:

<Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="Fixed_Asset_Master">
    <Table>
      <Row>
        <Cell><Data ss:Type="String">Fixed_Asset</Data></Cell>
        <Cell><Data ss:Type="String">Fixed_Asset_Description</Data></Cell>
        <Cell><Data ss:Type="String">Fixed_Asset_Class</Data></Cell>
        <Cell><Data ss:Type="String">Company</Data></Cell>
        <Cell><Data ss:Type="String">Set_of_Books</Data></Cell>
        <Cell><Data ss:Type="String">Capitalization_Date</Data></Cell>
      </Row>
      <Row>
        <Cell><Data ss:Type="String">FA1001</Data></Cell>
        <Cell><Data ss:Type="String">High-End Laptop</Data></Cell>
        <Cell><Data ss:Type="String">1000</Data></Cell>
        <Cell><Data ss:Type="String">1001</Data></Cell>
        <Cell><Data ss:Type="String">SOB001</Data></Cell>
        <Cell><Data ss:Type="String">2024-01-01</Data></Cell>
      </Row>
    </Table>
  </Worksheet>

  <Worksheet ss:Name="DefaultSetofBook">
    <Table>
      <Row>
        <Cell><Data ss:Type="String">Company_ID</Data></Cell>
        <Cell><Data ss:Type="String">Default_Set_of_Book_ID</Data></Cell>
      </Row>
      <Row>
        <Cell><Data ss:Type="String">1001</Data></Cell>
        <Cell><Data ss:Type="String">SOB001</Data></Cell>
      </Row>
    </Table>
  </Worksheet>
</Workbook>


<?xml version="1.0" encoding="UTF-8"?>
<xs:schema 
    xmlns:xs="http://www.w3.org/2001/XMLSchema"
    targetNamespace="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
    elementFormDefault="qualified"
    attributeFormDefault="unqualified">

  <xs:element name="Workbook">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="Worksheet" maxOccurs="2">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Table">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="Row" maxOccurs="unbounded">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:choice minOccurs="1" maxOccurs="6">
                            <xs:element name="Cell" maxOccurs="unbounded">
                              <xs:complexType>
                                <xs:sequence>
                                  <xs:element name="Data">
                                    <xs:complexType>
                                      <xs:simpleContent>
                                        <xs:extension base="xs:string">
                                          <xs:attribute ref="ss:Type" use="required"/>
                                        </xs:extension>
                                      </xs:simpleContent>
                                    </xs:complexType>
                                  </xs:element>
                                </xs:sequence>
                              </xs:complexType>
                            </xs:element>
                          </xs:choice>
                        </xs:sequence>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
            <xs:attribute name="Name" use="required">
              <xs:simpleType>
                <xs:restriction base="xs:string">
                  <xs:enumeration value="Fixed_Asset_Master"/>
                  <xs:enumeration value="DefaultSetofBook"/>
                </xs:restriction>
              </xs:simpleType>
            </xs:attribute>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>

  <!-- Attribute definitions -->
  <xs:attribute name="Type" type="xs:string"/>
</xs:schema>




/Fixed_Asset_Master/DefaultSetofBook/Company_ID, /Fixed_Asset_Master/DefaultSetofBook/Default_Set_of_Book_ID, /Fixed_Asset_Master/MasterData/Company, /Fixed_Asset_Master/MasterData/Set_of_Books -> /Fixed_Asset/General/BUKRS
Transformationsregel:
- Prüfe, ob Company in der Liste der Company_IDs (aus DefaultSetOfBook) vorhanden ist 
- Wenn ja: prüfe, ob Set_of_Books dem Default_Set_of_Book_ID entspricht, das zur Company_ID gehört
	- Wenn ja: Gib Company als Zielwert aus
 	- Wenn nein: Kein Output, Zeile wird ignoriert
- Wenn nein: Gib eine Fehlermeldung aus

/Fixed_Asset_Master/DefaultSetofBook/Company_ID, /Fixed_Asset_Master/DefaultSetofBook/Default_Set_of_Book_ID, /Fixed_Asset_Master/MasterData/Company, /Fixed_Asset_Master/MasterData/Set_of_Books, /Fixed_Asset_Master/MasterData/Fixed_Asset -> /Fixed_Asset/General/ANLN1, /Fixed_Asset/General/INVENTORY, /Fixed_Asset/General/ANLN2
Transformationsregel:
- Prüfe, ob Company in der Liste der Company_IDs (aus DefaultSetOfBook) vorhanden ist 
- Wenn ja: prüfe, ob Set_of_Books dem Default_Set_of_Book_ID entspricht, das zur Company_ID gehört
	- Wenn ja: Gib Fixed_Asset als Zielwert aus
 	- Wenn nein: Kein Output, Zeile wird ignoriert
- Wenn nein: Gib eine Fehlermeldung aus
	
/Fixed_Asset_Master/DefaultSetofBook/Company_ID, /Fixed_Asset_Master/DefaultSetofBook/Default_Set_of_Book_ID, /Fixed_Asset_Master/MasterData/Company, /Fixed_Asset_Master/MasterData/Set_of_Books, /Fixed_Asset_Master/MasterData/Fixed_Asset -> /Fixed_Asset/General/ANLKL,
- Prüfe, ob Company in der Liste der Company_IDs (aus DefaultSetOfBook) vorhanden ist 
- Wenn ja: prüfe, ob Set_of_Books dem Default_Set_of_Book_ID entspricht, das zur Company_ID gehört
	- Wenn ja: Gib Fixed_Asset als Zielwert aus
 	- Wenn nein: Kein Output, Zeile wird ignoriert
- Wenn nein: Gib eine Fehlermeldung aus

Output nach Skript, Namespace Entfernung und Mapping:


<?xml version='1.0' encoding='utf-8'?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
          xmlns:o="urn:schemas-microsoft-com:office:office"
          xmlns:x="urn:schemas-microsoft-com:office:excel"
          xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet">
  <Worksheet ss:Name="Fixed_Asset">
    <Table ss:ExpandedRowCount="11">
      <Row/>
      <Row/>
      <Row/>
      <Row/>
      <Row>
        <Cell><Data ss:Type="String">BUKRS</Data></Cell>
        <Cell><Data ss:Type="String">ANLN1</Data></Cell>
        <Cell><Data ss:Type="String">INVENTORY</Data></Cell>
        <Cell><Data ss:Type="String">ANLN2</Data></Cell>
        <Cell><Data ss:Type="String">ANLKL</Data></Cell>
      </Row>
      <Row>
        <Cell><Data ss:Type="String">Company Code</Data></Cell>
        <Cell><Data ss:Type="String">Main Asset Number</Data></Cell>
        <Cell><Data ss:Type="String">Inventory Number</Data></Cell>
        <Cell><Data ss:Type="String">Asset Subnumber</Data></Cell>
        <Cell><Data ss:Type="String">Asset Class</Data></Cell>
      </Row>
      <Row/>
      <Row>
        <Cell><Data ss:Type="String">Type: String</Data></Cell>
        <Cell><Data ss:Type="String">Type: String</Data></Cell>
        <Cell><Data ss:Type="String">Type: String</Data></Cell>
        <Cell><Data ss:Type="String">Type: String</Data></Cell>
        <Cell><Data ss:Type="String">Type: String</Data></Cell>
      </Row>
      <Row ss:AutoFitHeight="0">
        <Cell><Data ss:Type="String">1001</Data></Cell>                       <!-- BUKRS from Company -->
        <Cell><Data ss:Type="String">000000100001</Data></Cell>              <!-- ANLN1 (example Main Asset Number) -->
        <Cell><Data ss:Type="String">INV-FA1001</Data></Cell>                <!-- INVENTORY (generated e.g. from Fixed_Asset) -->
        <Cell><Data ss:Type="String">0000</Data></Cell>                      <!-- ANLN2 (defaulted) -->
        <Cell><Data ss:Type="String">1000</Data></Cell>                      <!-- ANLKL from Fixed_Asset_Class -->
      </Row>
    </Table>
  </Worksheet>
</Workbook>



<?xml version='1.0' encoding='UTF-8'?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
           elementFormDefault="qualified"
           attributeFormDefault="unqualified">
  <xs:element name="Workbook">
    <xs:complexType>
      <xs:sequence>
        <xs:element name="Worksheet" maxOccurs="unbounded">
          <xs:complexType>
            <xs:sequence>
              <xs:element name="Table">
                <xs:complexType>
                  <xs:sequence>
                    <xs:element name="Row" maxOccurs="unbounded">
                      <xs:complexType>
                        <xs:sequence>
                          <xs:element name="Cell" minOccurs="0" maxOccurs="unbounded">
                            <xs:complexType>
                              <xs:sequence>
                                <xs:element name="Data" minOccurs="0">
                                  <xs:complexType mixed="true">
                                    <xs:attribute name="ss:Type" type="xs:string" use="optional"/>
                                  </xs:complexType>
                                </xs:element>
                              </xs:sequence>
                              <xs:attribute name="ss:Index" type="xs:int" use="optional"/>
                            </xs:complexType>
                          </xs:element>
                        </xs:sequence>
                        <xs:attribute name="ss:AutoFitHeight" type="xs:string" use="optional" fixed="0"/>
                      </xs:complexType>
                    </xs:element>
                  </xs:sequence>
                  <xs:attribute name="ss:ExpandedColumnCount" type="xs:int" use="optional" fixed="10"/>
                  <xs:attribute name="ss:ExpandedRowCount" type="xs:int" use="optional" fixed="20"/>
                </xs:complexType>
              </xs:element>
            </xs:sequence>
            <xs:attribute name="ss:Name" type="xs:string" use="required" fixed="Fixed_Asset"/>
          </xs:complexType>
        </xs:element>
      </xs:sequence>
    </xs:complexType>
  </xs:element>
</xs:schema>

